/*
 * $Id: tprint.txt,v 1.5 2012/09/30 23:22:57 fyurisich Exp $
 */

CLASE TPRINT

TPRINT(ctlibrary)
  Inicializa la clase y establece la librería de impresión a usar.
  Retorna un objeto que permite configurar un trabajo de impresión,
  crearlo e imprimirlo o guardarlo en disco.
  Forma de uso:
    oTPrintObject := TPRINT(ctlibrary)
  Los valores posibles de ctlibrary son:
    "HBPRINTER"        Imprime usando la librería HBprinter
    "MINIPRINT"        Imprime usando la librería Miniprint
    "DOSPRINT"         Imprime directamente a impresora como DOS
    "CALCPRINT"        Imprime generando un archivo OpenOffice CALC
                       (hay que tener OpenOffice instalado)
    "EXCELPRINT"       Genera un archivo Excel
                       (hay que tener Excel instalado)
    "RTFPRINT"         Genera un archivo formato RTF
    "HTMLPRINT"        Genera un archivo HTML
    "PDFPRINT"         Genera un archivo PDF
    "CSVPRINT"         Genera un archivo con sus elementos separados
                       por comas (CSV)
    "RAWPRINT"         Imprime directamente a una cola de spool
                       (en formato binario)
    "SPREADSHEETPRINT" Genera un archivo Excel en formato BIFF
                       (no se necesita Excel ni OpenOffice)
  Si se omite el parámetro, la librería seleccionada depende de la
  variable _OOHG_PrintLibrary (vea más adelante).
  Si el tipo del parámetro no es string o, siendo string, no es un
  valor válido, la librería seleccionada es "MINIPRINT".



MÉTODOS PRINCIPALES

Se detallan a continuación los métodos disponibles y sus parámetros.
Nota: Todos los parámetros de todos los métodos son opcionales.


::Init()
  Inicializa algunas variables necesarias para cada librería.

::SelPrinter(lselect, lpreview, llandscape, npapersize, cprinterx, lshow, nres, nbin)
  Inicializa la impresora.
    lselect    = .T. muestra cuadro de diálogo para seleccionar impresora
    lselect    = .F. utiliza la impresora por defecto
    lpreview   = .T. muestra la vista previa antes de imprimir (valor por defecto)
    lpreview   = .F. no muestra la vista previa
    llandscape = .T. impresión horizontal
    llanscape  = .F. impresión vertical
    npapersize =     tamaño del papel según estándares del HBPRINTER,
                     ver al final de este documento
    cprinterx  =     nombre de la impresora si se quiere hacer una impresión
                     directa sin usar la impresora por defecto y sin
                     seleccionarla por diálogo
    lshow      = .T. muestra la ventana de espera mientras se prepara la impresión (valor por defecto)
    lshow      = .F. oculta la ventana de espera mientras se prepara la impresión
    nres       =     resolución, defaults to PRINTER_RES_MEDIUM
    nbin       =     número de bandeja de la cual se toma el papel (defaults to NIL)

::BeginDoc(cname)
  Inicia el documento.
    cname = nombre del documento (si no se coloca asume por defecto
            el de la librería de impresión.
  En los casos en que se genera un archivo, cName es también el nombre del
  archivo generado con la extensión del tipo de archivo generado.
  En caso de necesitar guardarlo en una carpeta diferente de la actual la
  ruta deberá incluirse en el nombre.

::SetPreviewSize()
  Setea el tamaño del preview para HBPRINTER (no tiene efecto para las
  demás librerías).
  Los valores pueden ser:
    1 menor
    2 más grande
    3 aún más grande
    etc.

::BeginPage()
  Empieza una página.

::PrintData(nfila, ncolumna, dato a imprimir, ctipoletra, ntamañoletra,
            lbold, acolor, calineacion, nancho)
  Imprime datos.
    nfila =           fila de impresión
    ncolumna =        columna de impresión
    dato a imprimir = puede ser de cualquier tipo
    ctipoletra =      tipo de letra a usar, si no se especifica toma la
                      que está en curso (por defecto Courier New)
    ntamañoletra =    tamaño de la letra en puntos
    lbold = .T.       negrita
    lbold = .F.       normal
    acolor =          arreglo RGB para darle un color al texto
    calineacion =     alineación del dato:
                        "L" izquierda (opción por defecto)
                        "C" centro
                        "R" derecha
    nancho =          tamaño del campo, se debe utilizar cuando se quiere
                      alinear al centro o a la derecha, por defecto es 15

::PrintImage(nfila, ncol, nfilaf, ncolf, cimagen)
  Imprime una imagen.
    nfila =   fila de impresión inicial
    ncol =    columna inicial
    nfilaf =  fila final
    ncolf =   columna final
    cimagen = gráfico a imprimir

::PrintLine(nfila, ncol, nfilaf, ncolf, atcolor, ntwpen)
  Imprime una línea desde una posición hasta otra.
    nfila =   fila de impresión inicial
    ncol =    columna inicial
    nfilaf =  fila final
    ncolf =   columna final
    atcolor = arreglo RGB del color a usar
    ntwpen =  ancho del pincel, por defecto 1
  Nota: si es DOS solo imprime si la línea inicial es igual a la final.

::PrintRectangle(nfila, ncol, nfilaf, ncolf, atcolor, ntwpen)
  Imprime un rectángulo.
    nfila =   fila de impresión inicial
    ncol =    columna inicial
    nfilaf =  fila final
    ncolf =   columna final
    atcolor = arreglo RGB del color a usar
    ntwpen =  ancho del pincel, por defecto 1

::PrintRoundRectangle(nfila, ncol, nfilaf, ncolf, atcolor, ntwpen)
  Imprime un rectángulo con esquinas redondeadas.
    nfila =   fila de impresión inicial
    ncol =    columna inicial
    nfilaf =  fila final
    ncolf =   columna final
    atcolor = arreglo RGB del color a usar
    ntwpen =  ancho del pincel  por defecto 1

::SetColor(atcolor)
  Setea el color en curso a un nuevo valor.
    atcolor = arreglo RGB

::GetDefPrinter()
  Obtiene la impresora por defecto.

::SetUnits(cunits)
  Establece las unidades a usar. Por defecto usa ROWCOL aunque
  internamente todo se hace en MM para que sea más exacto entre
  varias impresoras.
    cunits = los posibles valores son "MM" y "ROWCOL"

::EndPage()
  Finaliza una página.

::EndDoc()
  Termina un documento.

::Release()
  Libera el objeto TPRINT.

::Version()
  Devuelve la versión de la clase.

::SetLMargin(nlmar)
  Establece el margen izquierdo.

::SetTMargin(ntmar)
  Establece el margen superior.

::SetFont(cfont, nsize, acolor, lbold, litalic)
  Establece la fuente por defecto.
  cfont =   nombre
  nsize =   tamaño
  acolor =  color
  lbold =   negrita
  litalic = itálica

::SetCPL(ncpl)
  Establece la tamaño de la fuente en caracters por línea.
  Los valores válidos de ncpl son:
     60 - se usa tamaño de fuente 14
     80 - se usa tamaño de fuente 12 (valor por defecto)
     96 - se usa tamaño de fuente 10
    120 - se usa tamaño de fuente  8
    140 - se usa tamaño de fuente  7
    160 - se usa tamaño de fuente  6

::PrintBarCode(nlin, ncol, cbarcode, ctipo, acolor, lhori, nwidth, nheight)
  Imprime un código de barras.
    nlin =     fila donde se imprimirá
    ncol =     columna donde se imprimirá
    cbarcode = código a imprimir
    ctipo =    tipo de codificación
    acolor =   color
    lhori =    orientación (.T. = horizontal, .F. vertical)
    nwidth =   ancho de las barras
    nheight =  alto de las barras

:SetProp(lmode)
  Establece si el alto de las filas a imprimir será proporcional al
  tamaño de la letra actual global (lmode = .T.) o si será proporcional
  al tamaño de fuente 10 (lmode = .F.).



VARIABLES IMPORTANTES

_OOHG_PrintLibrary
  Definiendo esta variable como pública, es posible indicar la librería de
  impresión a usar por defecto. Se puede utilizar cualquiera de los valores
  del parámetro ctlibrary. Esta variable es muy útil para utilizar los
  comandos "Report form", "Edit" y "Edit Extended".
  Si no está definida o si su tipo no es string, la librería por defecto
  es "MINIPRINT". Si es un string no válido, es "HBPRINTER".


::aPrinters
  Arreglo de las impresoras disponibles en el sistema.

::aPorts
  Arreglo de los puertos disponibles en el sistema.

::lPrError
  Variable lógica. Si ocurre un error devuelve .T., por defecto es .F.

::acolor
  Color actual del pincel utilizado en el dibujo de líneas y cuadros,
  por defecto negro.

::cfontname
  Letra actual, por defecto Courier New.

::nfontsize
  Tamaño de letra actual global, por defecto 10. Usar con cuidado.

::afontcolor
  Color de la letra actual, por defecto negro.

::lfontbold
  .T. si la letra actual está en negrita.

::lfontitalic
  .T. si la letra actual está en itálica.

::cversion
  Número de versión de la clase.



TAMAÑO DEL PAPEL

Ver miniprint.ch, i_report.ch o winprint.ch
Nota: no todos los tamaños están soportados en todas las versiones de
Windows, ver archivo wingdi.h en la carpeta include del compilador C.
